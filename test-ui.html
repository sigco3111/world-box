<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게임 데이터 관리 UI 테스트</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h1>UI 테스트</h1>
            
            <div class="tab-menu">
                <button class="tab-btn active" data-tab="settings">설정</button>
            </div>
            
            <div class="tools">
                <div class="tab-content active" id="settings-tab">
                    <h2>게임 데이터 관리</h2>
                    <div class="game-data-section">
                        <div class="data-info">
                            <p><strong>저장된 데이터 크기:</strong> <span id="data-size">계산 중...</span></p>
                            <p><strong>마지막 저장:</strong> <span id="last-save-time">없음</span></p>
                        </div>
                        <div class="data-controls">
                            <button id="manual-save-btn" class="action-btn">수동 저장</button>
                            <button id="reset-game-btn" class="danger-btn">게임 초기화</button>
                            <button id="clear-data-btn" class="danger-btn">모든 데이터 삭제</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="map-container">
            <canvas id="map" width="800" height="600"></canvas>
        </div>
    </div>

    <!-- 상태 알림 컨테이너 -->
    <div id="game-state-notifications" class="state-notifications"></div>

    <!-- 확인 대화상자 -->
    <div id="confirmation-dialog" class="confirmation-dialog">
        <h3 id="dialog-title">확인</h3>
        <p id="dialog-message">정말로 실행하시겠습니까?</p>
        <div class="confirmation-buttons">
            <button id="dialog-confirm" class="confirm-btn">확인</button>
            <button id="dialog-cancel" class="cancel-btn">취소</button>
        </div>
    </div>

    <script src="gameStateManager.js"></script>
    <script src="gameDataUI.js"></script>
    <script>
        // 테스트용 전역 변수 설정
        window.nations = [
            { id: 1, name: '테스트 국가', color: '#ff0000', population: 1000000, stability: 80 }
        ];
        window.nextNationId = 2;
        window.selectedNation = null;
        window.currentYear = 100;
        window.simulationRunning = false;
        
        // 테스트용 pixelMap 객체
        window.pixelMap = {
            terrainMap: [['grassland', 'forest'], ['sand', 'water']],
            nationMap: [[1, null], [null, null]],
            cityMap: [{ x: 0, y: 0, name: '테스트 도시', nationId: 1 }],
            provinceMap: [[1, null], [null, null]],
            provinceNames: [{ id: 1, name: '테스트 지방' }],
            zoomLevel: 1,
            panX: 0,
            panY: 0,
            mapWidth: 800,
            mapHeight: 600,
            render: function() { console.log('맵 렌더링'); },
            clearMap: function() { console.log('맵 초기화'); }
        };
        
        // DOM 로드 후 테스트 실행
        document.addEventListener('DOMContentLoaded', () => {
            console.log('UI 테스트 시작');
            
            // GameDataUI가 초기화되었는지 확인
            setTimeout(() => {
                if (window.gameDataUI) {
                    console.log('✓ GameDataUI 초기화 성공');
                    
                    // 테스트 데이터 저장
                    if (window.gameStateManager) {
                        window.gameStateManager.saveGameState(false);
                        console.log('✓ 테스트 데이터 저장 완료');
                        
                        // UI 업데이트 확인
                        setTimeout(() => {
                            window.gameDataUI.updateDataInfo();
                            console.log('✓ UI 업데이트 완료');
                        }, 500);
                    }
                } else {
                    console.error('✗ GameDataUI 초기화 실패');
                }
            }, 1000);
        });
    </script>
</body>
</html>