<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>알림 시스템 테스트</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h1>알림 시스템 테스트</h1>
            
            <div class="tools">
                <h2>알림 테스트</h2>
                <div class="notification-test-buttons">
                    <button id="test-success">성공 알림</button>
                    <button id="test-error">오류 알림</button>
                    <button id="test-warning">경고 알림</button>
                    <button id="test-info">정보 알림</button>
                    <button id="test-progress">진행 상태 알림</button>
                    <button id="test-update-progress">진행 상태 업데이트</button>
                    <button id="test-clear-all">모든 알림 제거</button>
                </div>
                
                <h2>게임 상태 관리 테스트</h2>
                <div class="gamestate-test-buttons">
                    <button id="test-save">게임 저장 테스트</button>
                    <button id="test-load">게임 불러오기 테스트</button>
                    <button id="test-reset">게임 초기화 테스트</button>
                </div>
                
                <h2>알림 상태</h2>
                <div id="notification-status">
                    <p>총 알림 수: <span id="total-count">0</span></p>
                    <p>진행 중인 알림: <span id="progress-count">0</span></p>
                </div>
            </div>
        </div>
        
        <div class="map-container">
            <div style="padding: 20px; color: #f0f0f0;">
                <h2>알림 시스템 테스트 페이지</h2>
                <p>왼쪽 버튼들을 클릭하여 다양한 알림을 테스트해보세요.</p>
                <p>알림은 화면 우측 상단에 표시됩니다.</p>
                
                <h3>테스트 기능:</h3>
                <ul>
                    <li>성공, 오류, 경고, 정보 알림 표시</li>
                    <li>진행 상태 알림 (자동으로 사라지지 않음)</li>
                    <li>진행 상태 업데이트</li>
                    <li>알림 수동 닫기</li>
                    <li>모든 알림 제거</li>
                    <li>게임 상태 관리 시스템과의 통합</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 상태 알림 컨테이너 -->
    <div id="game-state-notifications" class="state-notifications"></div>

    <script src="notificationSystem.js"></script>
    <script src="gameStateManager.js"></script>
    
    <script>
        // 테스트용 전역 변수
        let currentProgressId = null;
        let testGameStateManager = null;
        
        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // 테스트용 GameStateManager 인스턴스 생성
            testGameStateManager = new GameStateManager();
            
            // 기본 알림 테스트 버튼들
            document.getElementById('test-success').addEventListener('click', () => {
                window.notificationSystem.showSuccess('테스트 성공', '성공 알림이 정상적으로 표시되었습니다.');
                updateStatus();
            });
            
            document.getElementById('test-error').addEventListener('click', () => {
                window.notificationSystem.showError('테스트 오류', '오류 알림이 정상적으로 표시되었습니다.');
                updateStatus();
            });
            
            document.getElementById('test-warning').addEventListener('click', () => {
                window.notificationSystem.showWarning('테스트 경고', '경고 알림이 정상적으로 표시되었습니다.');
                updateStatus();
            });
            
            document.getElementById('test-info').addEventListener('click', () => {
                window.notificationSystem.showInfo('테스트 정보', '정보 알림이 정상적으로 표시되었습니다.');
                updateStatus();
            });
            
            document.getElementById('test-progress').addEventListener('click', () => {
                if (currentProgressId) {
                    window.notificationSystem.removeNotification(currentProgressId);
                }
                currentProgressId = window.notificationSystem.showProgress('진행 중', '작업을 진행하고 있습니다...');
                updateStatus();
            });
            
            document.getElementById('test-update-progress').addEventListener('click', () => {
                if (currentProgressId) {
                    const messages = [
                        '데이터를 처리하고 있습니다...',
                        '파일을 저장하고 있습니다...',
                        '검증을 수행하고 있습니다...',
                        '작업을 완료하고 있습니다...'
                    ];
                    const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                    window.notificationSystem.updateProgress(currentProgressId, '진행 중', randomMessage);
                } else {
                    window.notificationSystem.showWarning('진행 상태 없음', '먼저 진행 상태 알림을 생성해주세요.');
                }
                updateStatus();
            });
            
            document.getElementById('test-clear-all').addEventListener('click', () => {
                window.notificationSystem.clearAll();
                currentProgressId = null;
                updateStatus();
            });
            
            // 게임 상태 관리 테스트 버튼들
            document.getElementById('test-save').addEventListener('click', () => {
                // 테스트용 데이터 설정
                window.nations = [
                    { id: 1, name: '테스트 국가 1', population: 1000, stability: 80 },
                    { id: 2, name: '테스트 국가 2', population: 1500, stability: 70 }
                ];
                window.nextNationId = 3;
                window.currentYear = 100;
                window.pixelMap = {
                    terrainMap: [1, 2, 3],
                    nationMap: [1, 1, 2],
                    cityMap: [],
                    provinceMap: [],
                    provinceNames: [],
                    zoomLevel: 1,
                    panX: 0,
                    panY: 0,
                    mapWidth: 1200,
                    mapHeight: 800
                };
                
                testGameStateManager.saveGameState(true);
                updateStatus();
            });
            
            document.getElementById('test-load').addEventListener('click', () => {
                testGameStateManager.loadGameState(true);
                updateStatus();
            });
            
            document.getElementById('test-reset').addEventListener('click', () => {
                testGameStateManager.resetGame();
                updateStatus();
            });
            
            // 상태 업데이트
            function updateStatus() {
                setTimeout(() => {
                    const status = window.notificationSystem.getStatus();
                    document.getElementById('total-count').textContent = status.totalNotifications;
                    document.getElementById('progress-count').textContent = status.progressNotifications;
                }, 100);
            }
            
            // 초기 상태 업데이트
            updateStatus();
            
            // 주기적 상태 업데이트
            setInterval(updateStatus, 1000);
        });
    </script>
</body>
</html>